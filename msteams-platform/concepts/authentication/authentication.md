---
title: 对团队中的用户进行身份验证
description: 描述团队中的身份验证以及如何在应用程序中使用
keywords: 团队身份验证 OAuth SSO AAD
ms.openlocfilehash: d3ae57d9937c6794fb743b44ca8210a5afd181bf
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/01/2020
ms.locfileid: "41673114"
---
# <a name="authentication-in-teams"></a><span data-ttu-id="b06e8-104">团队中的身份验证</span><span class="sxs-lookup"><span data-stu-id="b06e8-104">Authentication in Teams</span></span>

> [!Note]
> <span data-ttu-id="b06e8-105">在移动客户端上基于 Web 的身份验证需要团队 JavaScript SDK 的1.4.1 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="b06e8-105">Web-based authentication on mobile clients requires version 1.4.1 or later of the Teams JavaScript SDK.</span></span>

<span data-ttu-id="b06e8-106">为了让您的应用程序能够访问受 Azure Active Directory 保护的用户信息，以及从其他服务（如 Facebook 和 Twitter）访问数据，您的应用程序必须与这些提供程序建立受信任的连接。</span><span class="sxs-lookup"><span data-stu-id="b06e8-106">In order for your app to access user information protected by Azure Active Directory, as well as access data from other services like Facebook and Twitter, your app will have to establish a trusted connection with those providers.</span></span> <span data-ttu-id="b06e8-107">如果您的应用程序需要在用户作用域中使用 Microsoft Graph Api，您还需要对用户进行身份验证以检索相应的身份验证令牌。</span><span class="sxs-lookup"><span data-stu-id="b06e8-107">If your app needs to use Microsoft Graph APIs in the user scope, you'll also need to authenticate the user to retrieve the appropriate authentication tokens.</span></span>

<span data-ttu-id="b06e8-108">在 Microsoft 团队中，有两个不同的身份验证流可供您的应用程序利用。</span><span class="sxs-lookup"><span data-stu-id="b06e8-108">In Microsoft Teams there are two different authentication flows for your app to take advantage of.</span></span> <span data-ttu-id="b06e8-109">您可以在嵌入在选项卡、配置页或任务模块中的[内容页](~/tabs/how-to/create-tab-pages/content-page.md)中执行传统的基于 web 的身份验证流。</span><span class="sxs-lookup"><span data-stu-id="b06e8-109">You can perform a traditional web-based authentication flow in a [content page](~/tabs/how-to/create-tab-pages/content-page.md) embedded in a tab, a configuration page, or a task module.</span></span> <span data-ttu-id="b06e8-110">如果您的应用程序包含对话的 bot，则可以使用 OAuthPrompt 流（也可以选择使用 Azure Bot 框架的令牌服务）在对话过程中对用户进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="b06e8-110">If your app contains a conversational bot you can use the OAuthPrompt flow (and optionally the Azure Bot Framework's token service) to authenticate a user as part of a conversation.</span></span>

## <a name="web-based-authentication-flow"></a><span data-ttu-id="b06e8-111">基于 Web 的身份验证流</span><span class="sxs-lookup"><span data-stu-id="b06e8-111">Web-based authentication flow</span></span>

<span data-ttu-id="b06e8-112">您需要对[选项卡](~/tabs/what-are-tabs.md)使用基于 web 的身份验证流，并且可以选择将其与[对话 bot](~/bots/what-are-bots.md)或[邮件扩展](~/messaging-extensions/what-are-messaging-extensions.md)一起使用。</span><span class="sxs-lookup"><span data-stu-id="b06e8-112">You'll need to use the web-based authentication flow for [tabs](~/tabs/what-are-tabs.md), and can choose to use it with [conversational bots](~/bots/what-are-bots.md) or [messaging extensions](~/messaging-extensions/what-are-messaging-extensions.md).</span></span> <span data-ttu-id="b06e8-113">您将使用 web 内容页中的[Microsoft 团队 JavaScript 客户端 SDK](/javascript/api/overview/msteams-client)启用身份验证，然后将该内容页嵌入到选项卡、配置页或任务模块中。</span><span class="sxs-lookup"><span data-stu-id="b06e8-113">You'll use the [Microsoft Teams JavaScript client SDK](/javascript/api/overview/msteams-client) in a web content page to enable authentication, then embed that content page in a tab, a configuration page, or a task module.</span></span> <span data-ttu-id="b06e8-114">如果要将基于 web 的身份验证流与对话机器人配合使用，则需要将[任务模块与 bot 结合使用](~/task-modules-and-cards/task-modules/task-modules-bots.md)。</span><span class="sxs-lookup"><span data-stu-id="b06e8-114">If you want to use the web-based authentication flow with a conversational bot, you'll need to [use a task module with a bot](~/task-modules-and-cards/task-modules/task-modules-bots.md).</span></span>

* <span data-ttu-id="b06e8-115">[选项卡中的身份验证流](~/tabs/how-to/authentication/auth-flow-tab.md)介绍了 tab 身份验证在团队中的工作方式。</span><span class="sxs-lookup"><span data-stu-id="b06e8-115">[Authentication flow in tabs](~/tabs/how-to/authentication/auth-flow-tab.md) describes how tab authentication works in Teams.</span></span> <span data-ttu-id="b06e8-116">这显示了用于选项卡的典型的基于 web 的身份验证流。</span><span class="sxs-lookup"><span data-stu-id="b06e8-116">This shows a typical web based authentication flow used for tabs.</span></span>
* <span data-ttu-id="b06e8-117">[选项卡中的 AZURE AD 身份验证](~/tabs/how-to/authentication/auth-tab-AAD.md)介绍了如何从团队中应用程序的选项卡中连接到 Azure Active Directory。</span><span class="sxs-lookup"><span data-stu-id="b06e8-117">[Azure AD authentication in tabs](~/tabs/how-to/authentication/auth-tab-AAD.md) describes how to connect to Azure Active Directory from within a tab in your app in Teams.</span></span>
* <span data-ttu-id="b06e8-118">[无提示身份验证（AZURE AD）](~/tabs/how-to/authentication/auth-silent-AAD.md)介绍如何使用 Azure Active Directory 减少应用中的登录/同意提示。</span><span class="sxs-lookup"><span data-stu-id="b06e8-118">[Silent authentication (Azure AD)](~/tabs/how-to/authentication/auth-silent-AAD.md) describes how to reduce sign-in/consent prompts in your app using Azure Active Directory.</span></span>
* <span data-ttu-id="b06e8-119">[Dotnet/c #](https://github.com/OfficeDev/microsoft-teams-sample-complete-csharp)或[JavaScript/node.js](https://github.com/OfficeDev/microsoft-teams-sample-complete-node)中的基于 Web 的身份验证</span><span class="sxs-lookup"><span data-stu-id="b06e8-119">Web-based authentication in [dotnet/C#](https://github.com/OfficeDev/microsoft-teams-sample-complete-csharp) or [JavaScript/Node.js](https://github.com/OfficeDev/microsoft-teams-sample-complete-node)</span></span>

## <a name="the-oauthprompt-flow-for-conversational-bots"></a><span data-ttu-id="b06e8-120">对话 bot 的 OAuthPrompt 流</span><span class="sxs-lookup"><span data-stu-id="b06e8-120">The OAuthPrompt flow for conversational bots</span></span>

<span data-ttu-id="b06e8-121">Azure Bot 框架的 OAuthPrompt 使使用会话 bot 的应用程序更易于进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="b06e8-121">The Azure Bot Framework’s OAuthPrompt makes authentication easier for apps using conversational bots.</span></span> <span data-ttu-id="b06e8-122">你也可以利用 Azure Bot 框架的令牌服务来协助令牌缓存。</span><span class="sxs-lookup"><span data-stu-id="b06e8-122">You can take advantage of Azure Bot Framework's token service to assist with token caching as well.</span></span>

<span data-ttu-id="b06e8-123">有关使用 OAuthPrompt 的详细信息，请参阅：</span><span class="sxs-lookup"><span data-stu-id="b06e8-123">For more information on using the OAuthPrompt see:</span></span>

* <span data-ttu-id="b06e8-124">[Bot 身份验证流程概述](~/bots/how-to/authentication/auth-flow-bot.md)介绍了如何在团队中的应用程序中的 Bot 中处理身份验证。</span><span class="sxs-lookup"><span data-stu-id="b06e8-124">[Bot authentication flow overview](~/bots/how-to/authentication/auth-flow-bot.md) describes how authentication works within a bot in your app in Teams.</span></span> <span data-ttu-id="b06e8-125">这显示了一个非基于 web 的身份验证流，用于所有版本的团队（web、桌面应用程序和移动应用）上的 bot</span><span class="sxs-lookup"><span data-stu-id="b06e8-125">This shows a non-web based authentication flow used for bots on all versions of Teams (web, desktop app, and mobile apps)</span></span>
* [<span data-ttu-id="b06e8-126">机器人身份验证</span><span class="sxs-lookup"><span data-stu-id="b06e8-126">Bot authentication</span></span>](~/bots/how-to/authentication/add-authentication.md)
* <span data-ttu-id="b06e8-127">[Dotnet/c #](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/46.teams-auth)或[JavaScript/node.js](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/46.teams-auth)中的 Bot 身份验证（v3 SDK）示例</span><span class="sxs-lookup"><span data-stu-id="b06e8-127">Bot authentication (v3 SDK) sample in [dotnet/C#](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/csharp_dotnetcore/46.teams-auth) or [JavaScript/Node.js](https://github.com/microsoft/BotBuilder-Samples/tree/master/samples/javascript_nodejs/46.teams-auth)</span></span>

## <a name="configure-your-identity-provider"></a><span data-ttu-id="b06e8-128">配置您的标识提供程序</span><span class="sxs-lookup"><span data-stu-id="b06e8-128">Configure your identity provider</span></span>

<span data-ttu-id="b06e8-129">无论您的应用程序使用的是哪种身份验证流（甚至您可能同时使用这两种），您都需要将标识提供程序配置为与您的团队应用程序进行通信。</span><span class="sxs-lookup"><span data-stu-id="b06e8-129">Regardless of which authentication flow your app is using (you might even be using both), you'll need to configure your identity provider to communicate with your Teams app.</span></span> <span data-ttu-id="b06e8-130">你将在此处找到的大部分示例和演练主要是使用 Azure Active Directory 作为你的标识提供程序。</span><span class="sxs-lookup"><span data-stu-id="b06e8-130">The majority of the samples and walkthroughs you'll find here will deal primarily with using Azure Active Directory as your identity provider.</span></span> <span data-ttu-id="b06e8-131">但是，无论您使用哪种标识提供程序，都将应用这些概念。</span><span class="sxs-lookup"><span data-stu-id="b06e8-131">The concepts however apply regardless of which identity provider you'll use.</span></span>

<span data-ttu-id="b06e8-132">有关详细信息，请参阅[配置标识提供程序](~/concepts/authentication/configure-identity-provider.md)</span><span class="sxs-lookup"><span data-stu-id="b06e8-132">For more information see [configuring an identity provider](~/concepts/authentication/configure-identity-provider.md)</span></span>
