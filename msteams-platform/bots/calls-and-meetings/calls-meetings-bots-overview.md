---
title: 呼叫和联机会议 Bot
description: 了解如何使用 Microsoft Graph Api 对呼叫和联机会议使用语音和视频与用户进行交互。
keywords: 呼叫音频视频 IVR 语音联机会议
ms.openlocfilehash: e89fc576a0688a65e86c03696619569c41b6a3a2
ms.sourcegitcommit: 61edf47c9dd1dbc1df03d0d9fb83bfedca4c423b
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2020
ms.locfileid: "43914614"
---
# <a name="calls-and-online-meetings-bots"></a><span data-ttu-id="629dc-104">呼叫和联机会议 bot</span><span class="sxs-lookup"><span data-stu-id="629dc-104">Calls and online meetings bots</span></span>

<span data-ttu-id="629dc-105">通过添加[用于呼叫和联机会议的 Microsoft Graph api](/graph/api/resources/communications-api-overview?view=graph-rest-beta)，microsoft 团队应用现在可以使用语音和视频以丰富的方式与用户进行交互。</span><span class="sxs-lookup"><span data-stu-id="629dc-105">With the addition of [Microsoft Graph APIs for calls and online meetings](/graph/api/resources/communications-api-overview?view=graph-rest-beta), Microsoft Teams apps can now interact with users in rich ways using voice and video.</span></span> <span data-ttu-id="629dc-106">这些 Api 允许您添加新功能，如交互式语音响应（IVR）、呼叫控制以及对呼叫和会议（包括桌面和应用程序共享）的实时音频和/或视频流的访问。</span><span class="sxs-lookup"><span data-stu-id="629dc-106">These APIs allow you to add new features such as interactive voice response (IVR), call control, and access to real-time audio and/or video streams for calls and meetings, including desktop and app sharing.</span></span>

<span data-ttu-id="629dc-107">若要在 Microsoft 团队应用程序中使用这些 Microsoft Graph Api，请创建一个 bot 并指定一些其他信息和权限，这些信息和权限将在其他地方介绍，但首先，了解一些核心概念、术语和约定非常重要：</span><span class="sxs-lookup"><span data-stu-id="629dc-107">To use these Microsoft Graph APIs in a Microsoft Teams app, you create a bot and specify some additional information and permissions which we'll describe elsewhere, but first, it's important to understand some core concepts, terminology, and conventions:</span></span>

* <span data-ttu-id="629dc-108">**音频/视频呼叫。**</span><span class="sxs-lookup"><span data-stu-id="629dc-108">**Audio/video calls.**</span></span> <span data-ttu-id="629dc-109">团队中的呼叫可以是纯音频或音频 + 视频。</span><span class="sxs-lookup"><span data-stu-id="629dc-109">Calls in Teams can be purely audio or audio+video.</span></span> <span data-ttu-id="629dc-110">为简洁起见，我们并不说 "音频/视频呼叫" 无处不在。我们只是说 "通话"。</span><span class="sxs-lookup"><span data-stu-id="629dc-110">For brevity's sake, we don't say "audio/video call" everywhere; we just say "call."</span></span>
* <span data-ttu-id="629dc-111">**呼叫类型。**</span><span class="sxs-lookup"><span data-stu-id="629dc-111">**Call types.**</span></span> <span data-ttu-id="629dc-112">呼叫可以是对等（在个人和你的 bot 之间），也可以是多方（你的 bot 以及组呼叫中的两个或多个用户）。</span><span class="sxs-lookup"><span data-stu-id="629dc-112">Calls are either peer-to-peer (between a person and your bot) or multiparty (your bot and two or more people in a group call).</span></span>
  <span data-ttu-id="629dc-113">![呼叫类型](~/assets/images/calls-and-meetings/call-types.png)：</span><span class="sxs-lookup"><span data-stu-id="629dc-113">![Call Types](~/assets/images/calls-and-meetings/call-types.png):</span></span>
  * <span data-ttu-id="629dc-114">用户可以使用你的 bot 启动对等呼叫，或邀请你的 bot 加入现有的多方呼叫（尽管在 Microsoft 团队 UI 中尚未启用后者）。</span><span class="sxs-lookup"><span data-stu-id="629dc-114">A user may initiate a peer-to-peer call with your bot or invite your bot into an existing multiparty call (although the latter is not yet enabled in the Microsoft Teams UI).</span></span>
  * <span data-ttu-id="629dc-115">用户无需使用 Microsoft Graph 权限来启动与你的 bot 的对等呼叫，但你的 bot 需要其他权限来参与多方呼叫，或者你的 bot 启动与用户的对等呼叫。</span><span class="sxs-lookup"><span data-stu-id="629dc-115">Microsoft Graph permissions aren't necessary for a user to initiate a peer-to-peer call with your bot, but additional permissions are needed for your bot to participate in a multiparty call, or for your bot to initiate a peer-to-peer call with a user.</span></span>
  * <span data-ttu-id="629dc-116">呼叫可以作为对等启动，并升级到多方。</span><span class="sxs-lookup"><span data-stu-id="629dc-116">A call may start as peer-to-peer and escalate to multiparty.</span></span> <span data-ttu-id="629dc-117">你的 bot 可以通过邀请其他人来启动此升级，前提是你的 bot 具有适当的权限。</span><span class="sxs-lookup"><span data-stu-id="629dc-117">Your bot can initiate this escalation by inviting others, provided your bot has the proper permissions.</span></span> <span data-ttu-id="629dc-118">如果你的 bot 没有参与组呼叫的权限，并且一个参与者添加了另一方，则你的 bot 将从呼叫中删除。</span><span class="sxs-lookup"><span data-stu-id="629dc-118">If your bot doesn't have permissions to participate in group calls and one participant adds another party, your bot is dropped from the call.</span></span>
* <span data-ttu-id="629dc-119">**令.**</span><span class="sxs-lookup"><span data-stu-id="629dc-119">**Signaling.**</span></span> <span data-ttu-id="629dc-120">有两种类型的信号：传入呼叫和待命：</span><span class="sxs-lookup"><span data-stu-id="629dc-120">There are two types of signals — incoming call and in-call:</span></span>
  * <span data-ttu-id="629dc-121">若要接收传入呼叫，请在你的 bot 设置中指定终结点;传入呼叫到达时，此终结点收到通知。</span><span class="sxs-lookup"><span data-stu-id="629dc-121">To receive an incoming call, you specify an endpoint in your bot settings; this endpoint receives a notification when an incoming call arrives.</span></span> <span data-ttu-id="629dc-122">您可以应答呼叫、拒绝呼叫，或将其重定向到某个位置或其他人。</span><span class="sxs-lookup"><span data-stu-id="629dc-122">You can answer the call, reject it, or redirect it to somewhere or someone else.</span></span>
  <span data-ttu-id="629dc-123">![呼叫类型](~/assets/images/calls-and-meetings/call-handling.png)</span><span class="sxs-lookup"><span data-stu-id="629dc-123">![Call Types](~/assets/images/calls-and-meetings/call-handling.png)</span></span>
  * <span data-ttu-id="629dc-124">当 bot 在呼叫中时，会有用于静音和观众本身的 Api，并可启动/停止与其他参与者共享视频/桌面内容。</span><span class="sxs-lookup"><span data-stu-id="629dc-124">When a bot is in a call, there are APIs for muting and unmuting itself and to start/stop sharing video/desktop content with the other participants.</span></span>
  * <span data-ttu-id="629dc-125">Bot 还可以访问参与者列表、邀请新参与者并将其静音。</span><span class="sxs-lookup"><span data-stu-id="629dc-125">The bot can also access the list of participants, invite new participants, and mute them.</span></span>
* <span data-ttu-id="629dc-126">**呼叫和联机会议。**</span><span class="sxs-lookup"><span data-stu-id="629dc-126">**Calls and online meetings.**</span></span> <span data-ttu-id="629dc-127">从团队用户的角度来看，有两种类型的在线会议—临时和计划的。</span><span class="sxs-lookup"><span data-stu-id="629dc-127">From a Teams user's perspective, there are two kinds of online meetings — ad hoc and scheduled.</span></span> <span data-ttu-id="629dc-128">但是，从 bot 的角度来看，这是不同的。</span><span class="sxs-lookup"><span data-stu-id="629dc-128">However, from a bot's perspective, it's different.</span></span> <span data-ttu-id="629dc-129">在 bot 中，联机会议只是一个多方呼叫（一组参与者）加上 "会议协调"，您可以将其视为会议`botId`的元数据：、 `chatId`与会议、 `joinUrl`、 `startTime` / `endTime`等相关联。</span><span class="sxs-lookup"><span data-stu-id="629dc-129">To a bot, an online meeting is just a multiparty call (the set of participants) plus "meeting coordinates," which you can think of as the metadata for the meeting: `botId`, `chatId` associated with the meeting, `joinUrl`, `startTime`/`endTime`, and more.</span></span>
* <span data-ttu-id="629dc-130">**实时媒体。**</span><span class="sxs-lookup"><span data-stu-id="629dc-130">**Real-time media.**</span></span> <span data-ttu-id="629dc-131">当机器人参与呼叫或联机会议时，它必须处理音频和视频流。</span><span class="sxs-lookup"><span data-stu-id="629dc-131">When a bot is participating in a call or online meeting, it must deal with audio and video streams.</span></span> <span data-ttu-id="629dc-132">当用户在通话中进行通话、在网络摄像机上显示自己或在会议中显示其屏幕时，bot 会 "将" 视为音频和/或视频流。</span><span class="sxs-lookup"><span data-stu-id="629dc-132">When users talk on a call, show themselves on a webcam, or present their screens in a meeting, a bot "sees" this as audio and/or video streams.</span></span> <span data-ttu-id="629dc-133">如果你的 bot 想要说出某个内容或呈现屏幕内容，则需要音频或视频流。</span><span class="sxs-lookup"><span data-stu-id="629dc-133">If a bot wants to say something or present screen content, that requires an audio or video stream.</span></span> <span data-ttu-id="629dc-134">甚至像 bot 这样简单的东西，在 IVR （交互式语音响应）方案中，"按0键到达操作员" 是指播放。WAV 文件。</span><span class="sxs-lookup"><span data-stu-id="629dc-134">Even something as simple as the bot saying, "press 0 to reach the operator" in an IVR (interactive voice response) scenario means playing a .WAV file.</span></span> <span data-ttu-id="629dc-135">我们将其统称为_媒体_或_实时媒体_（指的是必须实时处理媒体的方案，而不是在播放之前录制的音频/视频时）。</span><span class="sxs-lookup"><span data-stu-id="629dc-135">Collectively, we refer to this as _media_ or _real-time media_ (when referring to scenarios where media must be processed in real time, as opposed to playback of previously-recorded audio/video).</span></span> <span data-ttu-id="629dc-136">过去，处理媒体流（尤其是实时媒体流）对于开发人员来说非常复杂。</span><span class="sxs-lookup"><span data-stu-id="629dc-136">Historically, dealing with media streams, particularly real-time media streams, has been extremely complex for developers.</span></span> <span data-ttu-id="629dc-137">Microsoft 已经创建了_实时媒体平台_来处理这些用例，并尽可能多地分担实时 "大量提升" 的实时媒体处理。</span><span class="sxs-lookup"><span data-stu-id="629dc-137">Microsoft has created the _Real-time Media Platform_ to handle these use cases and to offload as much of the traditional "heavy lifting" of real-time media processing as possible.</span></span>  <span data-ttu-id="629dc-138">当机器人接听来电或加入新呼叫或现有呼叫时，需要告诉实时媒体平台如何处理媒体。</span><span class="sxs-lookup"><span data-stu-id="629dc-138">When the bot answers an incoming call, or joins a new or existing call, it needs to tell the Real-time Media Platform how media will be handled.</span></span> <span data-ttu-id="629dc-139">如果您正在构建 IVR 应用程序，则可以将昂贵的音频处理卸载给 Microsoft。</span><span class="sxs-lookup"><span data-stu-id="629dc-139">If you're building an IVR application, you can offload the expensive audio processing to Microsoft.</span></span> <span data-ttu-id="629dc-140">或者，如果你的 bot 需要直接访问媒体流，我们也支持此方案。</span><span class="sxs-lookup"><span data-stu-id="629dc-140">Alternatively, if your bot requires direct access to media streams, we support that scenario too.</span></span> <span data-ttu-id="629dc-141">有两种类型的媒体处理：</span><span class="sxs-lookup"><span data-stu-id="629dc-141">There are the two types of media processing:</span></span>
  * <span data-ttu-id="629dc-142">**服务承载的媒体。**</span><span class="sxs-lookup"><span data-stu-id="629dc-142">**Service-hosted media.**</span></span> <span data-ttu-id="629dc-143">Bot 重点关注管理应用程序工作流（例如，路由呼叫），并将音频处理卸载到 Microsoft 实时媒体平台。</span><span class="sxs-lookup"><span data-stu-id="629dc-143">Bots focus on managing application workflow (e.g., routing calls) and offload audio processing to the Microsoft Real-time Media Platform.</span></span> <span data-ttu-id="629dc-144">使用服务托管媒体，可以通过多种方式来实施和托管你的 bot。</span><span class="sxs-lookup"><span data-stu-id="629dc-144">With service-hosted media, you have several options to implement and host your bot.</span></span> <span data-ttu-id="629dc-145">服务托管的媒体 bot 可以作为无状态服务实现，因为它不会在本地处理媒体。</span><span class="sxs-lookup"><span data-stu-id="629dc-145">A service-hosted media bot can be implemented as a stateless service since it doesn't process media locally.</span></span> <span data-ttu-id="629dc-146">服务承载`PlayPrompt`的媒体 bot 可以使用 api，如播放音频剪辑、 `Record`录制音频剪辑或`SubscribeToTone`订阅 DTMF 声音（例如，知道用户已按0进入操作员的情况）。</span><span class="sxs-lookup"><span data-stu-id="629dc-146">Service-hosted media bots can use APIs such as `PlayPrompt` for playing an audio clip, `Record` for recording audio clips, or `SubscribeToTone` for subscribing to DTMF tones (e.g., knowing when a user has pressed 0 to reach the operator).</span></span>
  * <span data-ttu-id="629dc-147">**应用程序托管的媒体。**</span><span class="sxs-lookup"><span data-stu-id="629dc-147">**Application-hosted media.**</span></span> <span data-ttu-id="629dc-148">为了让机器人能够直接访问媒体，它需要特定的图形权限，但在你的 bot 提供程序后，[实时媒体库](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)和[图形呼叫 SDK](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/articles/index.html#graph-calling-sdk-and-stateful-client-builder)可帮助你构建丰富的实时媒体和呼叫机器人。</span><span class="sxs-lookup"><span data-stu-id="629dc-148">For a bot to get direct access to the media, it needs a specific Graph permission, but once your bot has it, the [Real-time Media Library](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) and the [Graph Calling SDK](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/articles/index.html#graph-calling-sdk-and-stateful-client-builder) helps you build rich, real-time media, calling bots.</span></span> <span data-ttu-id="629dc-149">应用程序托管的 bot 必须托管在 Windows 环境中，如下文中对[此](./requirements-considerations-application-hosted-media-bots.md)进行了详细介绍。</span><span class="sxs-lookup"><span data-stu-id="629dc-149">An Application-hosted bot must be hosted in a Windows environment, as described in more detail [here](./requirements-considerations-application-hosted-media-bots.md).</span></span>

## <a name="further-reading"></a><span data-ttu-id="629dc-150">进一步阅读</span><span class="sxs-lookup"><span data-stu-id="629dc-150">Further reading</span></span>

<span data-ttu-id="629dc-151">以下是有关如何创建和测试呼叫和联机会议 bot 的详细信息：</span><span class="sxs-lookup"><span data-stu-id="629dc-151">Here's more information on how to create and test calls and online meetings bots:</span></span>

* [<span data-ttu-id="629dc-152">Graph API 参考</span><span class="sxs-lookup"><span data-stu-id="629dc-152">Graph API reference</span></span>](/graph/api/resources/communications-api-overview?view=graph-rest-beta)
* [<span data-ttu-id="629dc-153">示例应用</span><span class="sxs-lookup"><span data-stu-id="629dc-153">Sample apps</span></span>](https://github.com/microsoftgraph/microsoft-graph-comms-samples)
* <span data-ttu-id="629dc-154">[为呼叫和联机会议 Bot](./registering-calling-bot.md#add-microsoft-graph-permissions) [注册支持呼叫和联机会议](./registering-calling-bot.md)以及 Microsoft Graph 权限的 bot</span><span class="sxs-lookup"><span data-stu-id="629dc-154">[Registering a bot that supports calls and online meetings](./registering-calling-bot.md) and [Microsoft Graph permissions for calls and online meetings bots](./registering-calling-bot.md#add-microsoft-graph-permissions)</span></span>
* [<span data-ttu-id="629dc-155">如何在本地电脑上开发呼叫和联机会议 bot</span><span class="sxs-lookup"><span data-stu-id="629dc-155">How to develop calling and online meeting bots on your local PC</span></span>](./debugging-local-testing-calling-meeting-bots.md)
* <span data-ttu-id="629dc-156">有关[实时媒体处理的详细信息](./real-time-media-concepts.md)，以及[支持应用程序承载的媒体所需的内容](./requirements-considerations-application-hosted-media-bots.md)</span><span class="sxs-lookup"><span data-stu-id="629dc-156">[More information on real-time media processing](./real-time-media-concepts.md), and [what's needed to support application-hosted media](./requirements-considerations-application-hosted-media-bots.md)</span></span>
* [<span data-ttu-id="629dc-157">有关处理传入呼叫通知的技术信息</span><span class="sxs-lookup"><span data-stu-id="629dc-157">Technical information on handling incoming call notifications</span></span>](./call-notifications.md)
